# 校园一卡通系统功能清单

## 一、系统架构设计

### 1.1 技术架构
- **前后端分离架构**
  - 前端：独立部署的Web应用
  - 后端：RESTful API服务
  - 数据接口：独立的API Gateway层
  - 应用功能：业务逻辑层独立封装

### 1.2 系统分层
- 表现层（前端UI）
- 接口层（API Gateway）
- 业务逻辑层（Business Service）
- 数据访问层（Data Access）
- 硬件对接层（Device Integration）

---

## 二、后端管理系统功能模块

### 2.1 卡务管理
#### 2.1.1 卡片管理
- 卡片发行（批量/单张）
- 卡片挂失与解挂
- 卡片补办
- 卡片注销
- 卡片状态查询
- 卡片余额管理
- 卡片充值记录
- 卡片消费记录
- 卡片信息修改
- 临时卡管理

#### 2.1.2 账户管理
- 账户余额查询
- 账户充值（现金/线上）
- 账户退款
- 账户冻结/解冻
- 账户流水查询
- 账户对账管理

#### 2.1.3 卡片类型配置
- 学生卡配置
- 教师卡配置
- 临时卡配置
- 访客卡配置
- 卡片权限配置

---

### 2.2 人脸管理
#### 2.2.1 人脸信息管理
- 人脸照片采集
- 人脸信息录入
- 人脸信息修改
- 人脸信息删除
- 人脸质量检测
- 人脸照片查看

#### 2.2.2 人脸数据下发
- 人脸数据批量下发
- 人脸数据增量下发
- 人脸数据删除下发
- 下发状态监控
- 下发失败重试
- 设备人脸库管理

#### 2.2.3 人脸识别配置
- 识别阈值设置
- 识别模式配置（1:1 / 1:N）
- 活体检测配置
- 人脸库容量管理

---

### 2.3 学校管理
#### 2.3.1 学校基础信息
- 学校信息维护
- 学校层级结构
- 校区管理
- 学校参数配置
- 学校Logo设置

#### 2.3.2 学期管理
- 学期创建与维护
- 学期时间设置
- 当前学期切换
- 历史学期查询

---

### 2.4 班级管理
#### 2.4.1 班级信息管理
- 班级创建
- 班级信息维护
- 班级人数统计
- 班级学生名单
- 班级升级/降级
- 班级合并/拆分
- 班级归档

#### 2.4.2 班级组织架构
- 年级管理
- 班级分配
- 班主任分配
- 任课教师分配

---

### 2.5 学生管理
#### 2.5.1 学生信息管理
- 学生信息录入（单个/批量导入）
- 学生信息修改
- 学生信息查询
- 学生照片管理
- 学生转班
- 学生转学
- 学生毕业
- 学生档案管理

#### 2.5.2 学生关联管理
- 学生与班级关联
- 学生与家长关联
- 学生与卡片关联
- 学生与人脸关联

---

### 2.6 教师管理
#### 2.6.1 教师信息管理
- 教师信息录入（单个/批量导入）
- 教师信息修改
- 教师信息查询
- 教师照片管理
- 教师离职/在职管理
- 教师档案管理

#### 2.6.2 教师关联管理
- 教师与班级关联
- 教师与学科关联
- 教师与卡片关联
- 教师与人脸关联

---

### 2.7 家长管理
#### 2.7.1 家长信息管理
- 家长信息录入
- 家长信息修改
- 家长信息查询
- 家长与学生关联
- 家长关系维护（父/母/监护人）

#### 2.7.2 家长账号管理
- 家长微信绑定
- 家长账号状态
- 家长权限设置
- 多子女关联管理

---

### 2.8 消费机管理（易科士设备）
#### 2.8.1 设备管理
- 设备注册
- 设备信息维护
- 设备状态监控
- 设备在线/离线状态
- 设备参数配置
- 设备分组管理
- 设备位置管理

#### 2.8.2 设备对接配置
- 易科士设备IP配置
- 通讯协议配置
- 端口配置
- 心跳检测配置
- 数据同步间隔配置
- 按学校配置设备参数

#### 2.8.3 刷卡消费
- 刷卡消费记录采集
- 消费金额设置
- 消费限额设置
- 消费时段限制
- 消费次数限制
- 消费黑名单管理

#### 2.8.4 人脸消费
- 人脸识别消费
- 人脸消费记录采集
- 人脸识别成功率统计
- 人脸消费流水查询

#### 2.8.5 消费数据管理
- 消费数据实时采集
- 消费数据查询统计
- 消费流水导出
- 消费对账管理
- 异常消费预警

#### 2.8.6 基础数据下发
- 黑名单下发
- 白名单下发
- 消费参数下发
- 时段规则下发
- 设备时间同步

---

### 2.9 考勤管理（海康设备）
#### 2.9.1 考勤设备管理
- 海康设备注册
- 设备信息维护
- 设备状态监控
- 设备在线/离线状态
- 设备参数配置
- 设备分组管理（教师考勤/学生考勤/门禁）

#### 2.9.2 海康设备对接配置
- 海康设备IP配置
- SDK对接配置
- 设备编号配置
- 通讯协议配置
- 端口配置
- 心跳检测配置
- 按学校配置设备参数

#### 2.9.3 刷卡考勤
- 刷卡考勤记录采集
- 刷卡考勤实时上传
- 刷卡考勤数据查询

#### 2.9.4 人脸考勤
- 人脸识别考勤
- 人脸考勤记录采集
- 人脸识别成功率统计
- 人脸考勤实时推送

#### 2.9.5 考勤数据采集
- 实时数据采集
- 历史数据补采
- 考勤数据解析
- 考勤数据存储
- 考勤数据去重

#### 2.9.6 基础数据下发
- 人员信息下发¬
- 人脸照片下发（单个/批量）
- 人脸特征下发
- 卡片信息下发
- 权限信息下发
- 时间组下发
- 考勤规则下发
- 下发状态跟踪

#### 2.9.7 考勤规则管理
- 考勤时段设置
- 上下学时间设置
- 迟到/早退规则
- 旷课规则
- 请假规则
- 节假日设置
- 调休设置

#### 2.9.8 考勤统计分析
- 日考勤统计
- 月考勤统计
- 学期考勤统计
- 班级考勤统计
- 个人考勤统计
- 迟到早退统计
- 缺勤统计
- 考勤报表生成
- 考勤数据导出

#### 2.9.9 考勤异常处理
- 异常考勤标记
- 考勤补录
- 考勤修正
- 异常原因记录

---

### 2.10 系统管理
#### 2.10.1 用户管理
- 管理员账号管理
- 用户信息维护
- 用户状态管理
- 用户密码重置

#### 2.10.2 角色管理
- 角色创建
- 角色信息维护
- 角色权限分配
- 角色成员管理
- 预设角色：
  - 超级管理员
  - 学校管理员
  - 财务管理员
  - 班主任
  - 教师
  - 家长

#### 2.10.3 权限管理
- 功能权限配置
- 数据权限配置
- 菜单权限配置
- 按钮权限配置
- API权限配置
- 权限继承关系

#### 2.10.4 组织架构权限
- 学校级权限
- 年级级权限
- 班级级权限
- 个人级权限

#### 2.10.5 操作日志
- 用户操作日志
- 系统运行日志
- 设备操作日志
- 数据变更日志
- 日志查询与分析

#### 2.10.6 系统配置
- 系统参数配置
- 接口配置
- 消息推送配置
- 文件存储配置
- 数据备份配置

---

### 2.11 报表统计
#### 2.11.1 消费报表
- 日消费统计
- 月消费统计
- 班级消费统计
- 个人消费统计
- 消费排行榜
- 消费趋势分析

#### 2.11.2 考勤报表
- 出勤率统计
- 迟到早退统计
- 缺勤统计
- 班级考勤对比
- 考勤异常分析

#### 2.11.3 财务报表
- 充值统计
- 退款统计
- 账户余额统计
- 资金流水报表
- 对账报表

---

## 三、微信端功能模块

### 3.1 家长端功能
#### 3.1.1 账号管理
- 微信登录/绑定
- 学生信息查看
- 子女切换（多子女）
- 个人信息修改

#### 3.1.2 消费查询
- 实时消费通知
- 消费记录查询
- 消费明细查看
- 消费统计分析
- 消费日历视图
- 消费趋势图表

#### 3.1.3 充值功能
- 在线充值（微信支付）
- 充值金额选择
- 充值记录查询
- 充值到账通知
- 充值发票申请

#### 3.1.4 考勤查询
- 实时考勤通知（进校/离校）
- 考勤记录查询
- 考勤统计查看
- 考勤照片查看
- 迟到早退提醒
- 缺勤提醒

#### 3.1.5 请假管理
- 请假申请提交
- 请假类型选择（病假/事假/其他）
- 请假时间选择
- 请假原因填写
- 请假附件上传（病假条等）
- 请假状态查询
- 请假记录查看
- 请假撤销

#### 3.1.6 人像采集
- 人脸照片上传
- 人脸照片拍摄
- 人脸质量检测提示
- 人脸采集进度查看
- 人脸采集审核状态

#### 3.1.7 消息通知
- 考勤消息推送
- 消费消息推送
- 余额不足提醒
- 请假审批通知
- 学校通知公告

#### 3.1.8 其他功能
- 挂失/解挂申请
- 补卡申请
- 意见反馈
- 帮助中心

---

### 3.2 教师端功能
#### 3.2.1 账号管理
- 微信登录/绑定
- 个人信息查看
- 密码修改

#### 3.2.2 班级管理
- 班级学生名单
- 学生信息查看
- 班级考勤统计

#### 3.2.3 考勤管理
- 学生考勤查询
- 考勤异常处理
- 考勤统计查看
- 考勤报表导出

#### 3.2.4 请假审批
- 请假申请审批
- 请假记录查询
- 批量审批
- 审批消息提醒

#### 3.2.5 消息通知
- 学校通知接收
- 班级通知发送
- 家长消息回复

---

### 3.3 学生端功能（可选）
#### 3.3.1 账号管理
- 微信登录/绑定
- 个人信息查看

#### 3.3.2 消费查询
- 消费记录查询
- 余额查询
- 消费统计

#### 3.3.3 考勤查询
- 个人考勤记录
- 考勤统计

#### 3.3.4 请假申请
- 请假提交
- 请假记录查看

---

## 四、数据接口层（API Gateway）

### 4.1 接口设计原则
- RESTful API设计规范
- 统一的接口响应格式
- 接口版本管理
- 接口文档自动生成（Swagger）

### 4.2 核心接口模块
#### 4.2.1 认证授权接口
- 登录认证
- Token刷新
- 权限验证
- 单点登录（SSO）

#### 4.2.2 基础数据接口
- 学校数据接口
- 班级数据接口
- 学生数据接口
- 教师数据接口
- 家长数据接口

#### 4.2.3 卡务数据接口
- 卡片信息接口
- 账户余额接口
- 充值记录接口
- 消费记录接口

#### 4.2.4 人脸数据接口
- 人脸信息接口
- 人脸上传接口
- 人脸下发接口
- 人脸识别结果接口

#### 4.2.5 设备对接接口
- 设备注册接口
- 设备状态接口
- 设备数据上传接口
- 设备参数配置接口
- 设备命令下发接口

#### 4.2.6 消费数据接口
- 消费数据上传接口
- 消费记录查询接口
- 消费统计接口

#### 4.2.7 考勤数据接口
- 考勤数据上传接口
- 考勤记录查询接口
- 考勤统计接口
- 请假数据接口

#### 4.2.8 微信端接口
- 微信登录接口
- 微信绑定接口
- 消息推送接口
- 支付接口

### 4.3 接口安全
- Token认证机制
- 接口签名验证
- 接口限流控制
- 接口加密传输（HTTPS）
- 敏感数据脱敏

### 4.4 接口监控
- 接口调用日志
- 接口性能监控
- 接口异常告警
- 接口调用统计

---

## 五、设备对接层

### 5.1 易科士消费机对接
#### 5.1.1 设备通讯
- TCP/IP通讯协议
- 设备心跳检测
- 断线重连机制
- 数据传输加密

#### 5.1.2 数据采集
- 实时消费数据采集
- 历史数据补采
- 数据解析与存储
- 数据去重处理

#### 5.1.3 参数配置
- 按学校配置设备IP
- 按学校配置通讯端口
- 按学校配置消费参数
- 按学校配置时段规则
- 按学校配置限额规则

#### 5.1.4 数据下发
- 黑白名单下发
- 消费参数下发
- 时间同步下发

---

### 5.2 海康考勤机对接
#### 5.2.1 设备通讯
- 海康SDK集成
- 设